
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Middlewares Â· Beidou Document</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../website-1510922488080.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="router.html" />
    
    
    <link rel="prev" href="plugins.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    About Beidou
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../quick-start/quick-start.html">
            
                <a href="../quick-start/quick-start.html">
            
                    
                    Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Step by Step
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../quick-start/prepare-environment.html">
            
                <a href="../quick-start/prepare-environment.html">
            
                    
                    Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../quick-start/directory-struct.html">
            
                <a href="../quick-start/directory-struct.html">
            
                    
                    Directory Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../quick-start/step-by-step.html">
            
                <a href="../quick-start/step-by-step.html">
            
                    
                    Step by Step
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="objects.html">
            
                <a href="objects.html">
            
                    
                    Built-in Objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="config.html">
            
                <a href="config.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="plugins.html">
            
                <a href="plugins.html">
            
                    
                    Plugins
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.4" data-path="middleware.html">
            
                <a href="middleware.html">
            
                    
                    Middlewares
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="router.html">
            
                <a href="router.html">
            
                    
                    Router
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="controller.html">
            
                <a href="controller.html">
            
                    
                    Controller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="service.html">
            
                <a href="service.html">
            
                    
                    Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="schedule.html">
            
                <a href="schedule.html">
            
                    
                    Schedule
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="extend.html">
            
                <a href="extend.html">
            
                    
                    Extend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="view.html">
            
                <a href="view.html">
            
                    
                    View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="Mock.html">
            
                <a href="Mock.html">
            
                    
                    Mock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="app-start.html">
            
                <a href="app-start.html">
            
                    
                    Custom Init
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Core
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../core/development.html">
            
                <a href="../core/development.html">
            
                    
                    Development
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../core/unittest.html">
            
                <a href="../core/unittest.html">
            
                    
                    Unit Testing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../core/logger.html">
            
                <a href="../core/logger.html">
            
                    
                    Logger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../core/http-client.html">
            
                <a href="../core/http-client.html">
            
                    
                    HttpClient
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../core/cookie-and-session.html">
            
                <a href="../core/cookie-and-session.html">
            
                    
                    Cookie & Session
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../core/cluster-and-ipc.html">
            
                <a href="../core/cluster-and-ipc.html">
            
                    
                    Cluster and IPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../core/isomorphic-render.html">
            
                <a href="../core/isomorphic-render.html">
            
                    
                    Ismorphic Render
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../core/error-handling.html">
            
                <a href="../core/error-handling.html">
            
                    
                    Error Handling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../core/security.html">
            
                <a href="../core/security.html">
            
                    
                    Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="../core/i18n.html">
            
                <a href="../core/i18n.html">
            
                    
                    Multi-language
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Deployment
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../deployment/deployment.html">
            
                <a href="../deployment/deployment.html">
            
                    
                    Deployment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../deployment/devops.html">
            
                <a href="../deployment/devops.html">
            
                    
                    DevOps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../deployment/docker.html">
            
                <a href="../deployment/docker.html">
            
                    
                    Docker
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    Tutorials
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../tutorials/progressive.html">
            
                <a href="../tutorials/progressive.html">
            
                    
                    Progressive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../tutorials/mysql.html">
            
                <a href="../tutorials/mysql.html">
            
                    
                    MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../tutorials/restful.html">
            
                <a href="../tutorials/restful.html">
            
                    
                    Restful API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../tutorials/async-function.html">
            
                <a href="../tutorials/async-function.html">
            
                    
                    Async Function
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    Advanced
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../advanced/architecture.html">
            
                <a href="../advanced/architecture.html">
            
                    
                    How It Works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../advanced/loader.html">
            
                <a href="../advanced/loader.html">
            
                    
                    Loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../advanced/plugin.html">
            
                <a href="../advanced/plugin.html">
            
                    
                    Plugin Development
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../advanced/cluster-enhancement.html">
            
                <a href="../advanced/cluster-enhancement.html">
            
                    
                    Cluster Enhancement
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../advanced/monitor.html">
            
                <a href="../advanced/monitor.html">
            
                    
                    Monitor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../advanced/performance.html">
            
                <a href="../advanced/performance.html">
            
                    
                    Performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="../advanced/oom.html">
            
                <a href="../advanced/oom.html">
            
                    
                    Memory Leaks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.8" data-path="../advanced/attentions.html">
            
                <a href="../advanced/attentions.html">
            
                    
                    SSR Attentions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../FAQ.html">
            
                <a href="../FAQ.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Middlewares</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="middleware">Middleware</h2>
<p>Since Beidou is based on Egg, and Egg is based on Koa, so the form of middleware in Beidou is the same as in Koa, i.e. they are both based on <a href="https://github.com/eggjs/egg/blob/master/docs/source/en/intro/egg-and-koa.md#midlleware" target="_blank">the onion model</a> of generator function.</p>
<h2 id="writing-middleware">Writing Middleware</h2>
<h3 id="how-to-write">How to write</h3>
<p>We begin to see how to write a middleware from a simple gzip example.</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> isJSON = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;koa-is-json&apos;</span>);
<span class="hljs-keyword">const</span> zlib = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;zlib&apos;</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">gzip</span>(<span class="hljs-params">next</span>) </span>{
  <span class="hljs-keyword">yield</span> next;

  <span class="hljs-comment">// convert the response body to gzip after the completion of the execution of subsequent middleware</span>
  <span class="hljs-keyword">let</span> body = <span class="hljs-keyword">this</span>.body;
  <span class="hljs-keyword">if</span> (!body) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (isJSON(body)) body = <span class="hljs-built_in">JSON</span>.stringify(body);

  <span class="hljs-comment">// set gzip body, correct the response header</span>
  <span class="hljs-keyword">const</span> stream = zlib.createGzip();
  stream.end(body);
  <span class="hljs-keyword">this</span>.body = stream;
  <span class="hljs-keyword">this</span>.set(<span class="hljs-string">&apos;Content-Encoding&apos;</span>, <span class="hljs-string">&apos;gzip&apos;</span>);
}
</code></pre>
<p>You might find that the middleware&apos;s writing style in the framework is exactly the same as in Koa, so any middleware in Koa can be used directly by the framework.</p>
<h3 id="configuration">Configuration</h3>
<p>Usually the middleware has its own configuration. In the framework, a complete middleware is including the configuration process. A middleware is a file in <code>app/middleware</code> directory by convention, which needs an exports function that take two parameters:</p>
<ul>
<li>options: the configuration field of the middleware, <code>app.config[${middlewareName}]</code> will be passed in by the framework</li>
<li>app: the Application instance of current application</li>
</ul>
<p>We will do a simple optimization to the gzip middleware above, making it do gzip compression only if the body size is greater than a configured threshold. So, we need to create a new file <code>gzip.js</code> in <code>app/middleware</code> directory.</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> isJSON = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;koa-is-json&apos;</span>);
<span class="hljs-keyword">const</span> zlib = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;zlib&apos;</span>);

<span class="hljs-built_in">module</span>.exports = options =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">gzip</span>(<span class="hljs-params">next</span>) </span>{
    <span class="hljs-keyword">yield</span> next;

    <span class="hljs-comment">// convert the response body to gzip after the completion of the execution of subsequent middleware</span>
    <span class="hljs-keyword">let</span> body = <span class="hljs-keyword">this</span>.body;
    <span class="hljs-keyword">if</span> (!body) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// support options.threshold</span>
    <span class="hljs-keyword">if</span> (options.threshold &amp;&amp; <span class="hljs-keyword">this</span>.length &lt; options.threshold) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">if</span> (isJSON(body)) body = <span class="hljs-built_in">JSON</span>.stringify(body);

    <span class="hljs-comment">// set gzip body, correct the response header</span>
    <span class="hljs-keyword">const</span> stream = zlib.createGzip();
    stream.end(body);
    <span class="hljs-keyword">this</span>.body = stream;
    <span class="hljs-keyword">this</span>.set(<span class="hljs-string">&apos;Content-Encoding&apos;</span>, <span class="hljs-string">&apos;gzip&apos;</span>);
  };
};
</code></pre>
<h2 id="using-middleware-in-application">Using Middleware in Application</h2>
<p>We can load customized middleware completely by configuration in the application, and decide their order.
If we need to load the gzip middleware in the above,
we can edit <code>config.default.js</code> like this:</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-comment">// configure the middleware you need, which loads in the order of array</span>
  middleware: [ <span class="hljs-string">&apos;gzip&apos;</span> ],

  <span class="hljs-comment">// configure the gzip middleware</span>
  gzip: {
    threshold: <span class="hljs-number">1024</span>, <span class="hljs-comment">// skip response body which size is less than 1K</span>
  },
};
</code></pre>
<p>This config will merge to <code>app.config.appMiddleware</code> on starting up.</p>
<h2 id="using-middleware-in-framework-and-plugin">Using Middleware in Framework and Plugin</h2>
<p>Framework and Plugin don&apos;t support <code>config.middleware</code>, you should mount it in <code>app.js</code>:</p>
<pre><code class="lang-js"><span class="hljs-comment">// app.js</span>
<span class="hljs-built_in">module</span>.exports = app =&gt; {
  <span class="hljs-comment">// &#x5728;&#x4E2D;&#x95F4;&#x4EF6;&#x6700;&#x524D;&#x9762;&#x7EDF;&#x8BA1;&#x8BF7;&#x6C42;&#x65F6;&#x95F4;</span>
  app.config.coreMiddleware.unshift(<span class="hljs-string">&apos;report&apos;</span>);
};

<span class="hljs-comment">// app/middleware/report.js</span>
<span class="hljs-built_in">module</span>.exports = () =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params">next</span>) </span>{
    <span class="hljs-keyword">const</span> startTime = <span class="hljs-built_in">Date</span>.now();
    <span class="hljs-keyword">yield</span> next;
    <span class="hljs-comment">// &#x4E0A;&#x62A5;&#x8BF7;&#x6C42;&#x65F6;&#x95F4;</span>
    reportTime(<span class="hljs-built_in">Date</span>.now() - startTime);
  }
};
</code></pre>
<p>Middlewares which defined at Application (<code>app.config.coreMiddleware</code>) and Framework(<code>app.config.coreMiddleware</code>) will be merge to <code>app.middleware</code> by loader at staring up.</p>
<h2 id="using-middleware-in-router">Using Middleware in Router</h2>
<p>Both middleware defined by the application layer and the default framework middleware is global, will process every request.</p>
<p>If you do want to take effect on the corresponding routes, you could just mount it at <code>app/router.js</code>:</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = app =&gt; {
  <span class="hljs-keyword">const</span> gzip = app.middlewares.gzip({ threshold: <span class="hljs-number">1024</span> });
  app.get(<span class="hljs-string">&apos;/needgzip&apos;</span>, gzip, app.controller.handler);
};
</code></pre>
<h2 id="default-framework-middleware">Default Framework Middleware</h2>
<p>In addition to the application-level middleware is loaded, the framework itself and other plugins will also load many middleware. All the config fields of these built-in middlewares can be modified by modifying the ones with the same name in the config file, for example <a href="https://github.com/eggjs/egg/tree/master/app/middleware" target="_blank">Framework Built-in Plugin</a> uses a bodyParser middleware(the framework loader will change the file name separated by delimiters into the camel style), and we can add configs below in <code>config/config.default.js</code> to modify the bodyParser:</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
  bodyParser: {
    jsonLimit: <span class="hljs-string">&apos;10m&apos;</span>,
  },
};
</code></pre>
<p><strong> Note: middleware loaded by the framework and plugins are loaded earlier than those loaded by the application layer, and the application layer cannot overwrite the default framework middleware. If the application layer loads customized middleware that has the same name with default framework middleware, an error will be raised on starting up. </strong></p>
<h2 id="use-koas-middleware">Use Koa&apos;s Middleware</h2>
<p>The framework is compatible with all kinds of middleware of Koa 1.x and 2.x, including:</p>
<ul>
<li>generator function: <code>function* (next) {}</code></li>
<li>async function: <code>async (ctx, next) =&gt; {}</code></li>
<li>common function: <code>(ctx, next) =&gt; {}</code></li>
</ul>
<p>All middleware used by Koa can be directly used by the framework, too.</p>
<p>For example, Koa uses <a href="https://github.com/koajs/compress" target="_blank">koa-compress</a> in this way:</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;koa&apos;</span>);
<span class="hljs-keyword">const</span> compress = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;koa-compress&apos;</span>);

<span class="hljs-keyword">const</span> app = koa();

<span class="hljs-keyword">const</span> options = { threshold: <span class="hljs-number">2048</span> };
app.use(compress(options));
</code></pre>
<p>We can load the middleware according to the framework specification like this:</p>
<pre><code class="lang-js"><span class="hljs-comment">// app/middleware/compress.js</span>

<span class="hljs-comment">// interfaces(`(options) =&gt; middleware`) exposed by koa-compress match the framework middleware requirements</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;koa-compress&apos;</span>);
</code></pre>
<pre><code class="lang-js"><span class="hljs-comment">// config/config.default.js</span>

exports.middleware = [ <span class="hljs-string">&apos;compress&apos;</span> ];
exports.compress = {
  threshold: <span class="hljs-number">2048</span>,
};
</code></pre>
<h2 id="general-configuration">General Configuration</h2>
<p>These general config fields are supported by middleware loaded by the application layer or built in by the framework:</p>
<ul>
<li>enable: enable the middleware or not</li>
<li>match: set some rules with which only the request match can go through middleware</li>
<li>ignore: set some rules with which the request match can&apos;t go through this middleware</li>
</ul>
<h3 id="enable">enable</h3>
<p>If our application does not need default bodyParser to resolve the request body, we can configure enable to close it.</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
  bodyParser: {
    enable: <span class="hljs-literal">false</span>,
  },
};
</code></pre>
<h3 id="match-and-ignore">match and ignore</h3>
<p>match and ignore share the same parameter but do the opposite things. match and ignore cannot be configured in the same time.</p>
<p>If we want gzip to be used only by url requests starting with <code>/static</code>, the match config field can be set like this:</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
  gzip: {
    match: <span class="hljs-string">&apos;/static&apos;</span>,
  },
};
</code></pre>
<p>match and ignore support various types of configuration ways:</p>
<ol>
<li>String: when string, it sets the prefix of a url path, and all urls starting with this prefix will match.</li>
<li>Regular expression: when regular expression, all urls satisfy this regular expression will match.</li>
<li>Function: when function, the request context will be passed to it and what it returns(true/false) determines whether the request matches or not.</li>
</ol>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = {
  gzip: {
    match(ctx) {
      <span class="hljs-comment">// enabled on ios devices</span>
      <span class="hljs-keyword">const</span> reg = <span class="hljs-regexp">/iphone|ipad|ipod/i</span>;
      <span class="hljs-keyword">return</span> reg.test(ctx.get(<span class="hljs-string">&apos;user-agent&apos;</span>));
    },
  },
};
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="plugins.html" class="navigation navigation-prev " aria-label="Previous page: Plugins">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="router.html" class="navigation navigation-next " aria-label="Next page: Router">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Middlewares","level":"1.4.4","depth":2,"next":{"title":"Router","level":"1.4.5","depth":2,"path":"basic/router.md","ref":"basic/router.md","articles":[]},"previous":{"title":"Plugins","level":"1.4.3","depth":2,"path":"basic/plugins.md","ref":"basic/plugins.md","articles":[]},"dir":"ltr"},"config":{"plugins":["antsay","-sharing","styles-less","livereload"],"styles":{"website":"website-1510922488080.css"},"pluginsConfig":{"antsay":{"useIdentifier":false,"shortName":"","appId":"","key":""},"styles-less":{},"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Beidou Document","gitbook":">= 3.2.0","description":"Beidou Document"},"file":{"path":"basic/middleware.md","mtime":"2017-11-17T09:37:47.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-11-17T09:27:56.242Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="https://say.alipay.net/public/antsay.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-antsay/bootstrap.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

